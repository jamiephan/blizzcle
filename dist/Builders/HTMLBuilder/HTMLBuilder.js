"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),fs=require("fs"),HTMLDateBuilder=require("./HTMLDateBuilder"),HTMLBuilder=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"blizzcle";(0,_classCallCheck2["default"])(this,a),this.data=b,this.game=c,this.filename=d,this._html=""}return(0,_createClass2["default"])(a,[{key:"build",value:function build(){this._addHead();for(var a,b=0;b<this.data.length;b++)a=this.data[b],this._html+="<tr><th scope=row class=hash>".concat(a.id+1,"</th><td><img class=lazyload data-src=").concat(a.thumbnail,"\n        src=https://dummyimage.com/260x130/a1a1a1/2b2b2b.gif?text=Loading.... /></td><td class=title><a href=").concat(a.link," target=\"_blank\">").concat(a.title,"</td></a><td class=dateStr>").concat(new HTMLDateBuilder(a.timestamp).format(),"</td><td class=date style=display:none>").concat(a.timestamp,"</td></tr>");this._addEnd()}},{key:"save",value:function(){var a=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function a(){var b=this;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,c){fs.writeFile(b.filename,b._html,{encoding:"utf8"},function(d){d?c(d):a(b.filename)})}));case 1:case"end":return a.stop();}},a)}));return function save(){return a.apply(this,arguments)}}()},{key:"_addHead",value:function _addHead(){this._html+="<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css><title>".concat(this.game," Article Viewer</title><style>th{cursor:pointer}img{width:260px;height:130px}</style><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js></script><script src=http://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js></script><script src=https://cdn.rawgit.com/tuupola/jquery_lazyload/2.x/lazyload.min.js></script></head><body><nav class=\"navbar navbar-light bg-light justify-content-between\"><a class=navbar-brand>").concat(this.game," Article Viewer</a><ul class=navbar-nav><a class=nav-link href=https://www.reddit.com/u/jamiephan>(by /u/jamiephan)</a></ul></nav><div class=container id=blogs><div class=row><div class=\"col s12\"><h1>Blogs</h1></div></div><div class=row><div class=\"col s4\"><input id=blog-search type=text class=\"search form-control\" placeholder=Search autocomplete=off></div></div><div class=row><div class=\"col s12\"><table class=\"table table-hover\"><thead><tr><th scope=col data-sort=hash data-asc=asc onclick=sort(this)>#</th><th scope=col>Thumbnail</th><th scope=col data-sort=title data-asc=asc onclick=sort(this)>Blog Title</th><th scope=col data-sort=date data-asc=asc onclick=sort(this)>Date (UTC)</th></tr></thead><tbody class=list>")}},{key:"_addEnd",value:function _addEnd(){this._html+=" </tbody> </table> </div></div></div><script>lazyload(); var options={valueNames: [\"hash\", \"title\", \"date\"]}; var blogList=new List(\"blogs\", options); function sort(a){blogList.sort(a.dataset.sort,{order: a.dataset.asc}); a.dataset.asc=(a.dataset.asc==\"asc\" ? \"desc\" : \"asc\")}; </script></body></html>"}}]),a}();module.exports=HTMLBuilder;